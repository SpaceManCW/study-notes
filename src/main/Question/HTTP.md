# HTTP
## 简介
HTTP(超文本传输协议)，是从万维网服务器传输超文本到本地浏览器的传送协议。浏览器作为HTTP客户端通过URL向HTTP服务器即web服务器发送请求。HTTP三要点：
- 无连接  每次连接只处理一个请求，结束就断开
- 媒体独立  只要客户端和服务器知道如何处理内容，任何数据类型都可以发送
- 无状态  无状态，不会记忆传输过的数据。下次要重新请求

## HTTP请求报文
一个HTTP请求由：请求行、请求头、请求体组成
- 请求行由请求方法、URL、协议版本组成
- 请求头，由若干属性组成，属性名：属性值 的形式。服务端通过请求头获取客户端的信息
- 请求体，就是请求的数据，请求体可以传递请求参数

## 常见请求头字段
- Accept 告诉服务端可以接受的数据类型，可以为一个或多个MIME类型
- Cookie Cookie就是通过HTTP请求头携带过去的
- Referer 表示请求是从哪个URL过来的
- Cache-Control 要求服务端返回的内容可以存的时间,设置为no-cache则希望响应内容不被客户端缓存，max-age=10则是10秒
- Connection  控制两端的连接状态，Connection: keep-alive连接不会关闭，继续访问还用这条连接
- Host通常在URL中提取出来，指定被请求资源的主机和端口号
- User-Agent  告诉服务器客户端使用的操作系统和浏览器版本
- Accept-Language 浏览器申明自己接受的语言

## HTTP响应报文
一个HTTP响应由：响应行、响应头、响应体组成
- 响应行由协议版本、状态码及状态描述组成
- 响应头，由若干属性组成，属性名：属性值 的形式。
- 响应体，就是得到的数据

## 常见响应头字段
- Cache-Control 服务器告诉客户端如何控制响应内容的缓存
- expires  响应过期的时间
- Last-Modified  请求资源的最后修改时间
- ETag  一个代表资源版本的属性，资源改变这个属性也会改变
- Location 是一个URL地址，让页面重定向到另一个页面，就是让其向另一个页面发请求
- Set-Cookie  服务端可以设置客户端的Cookie 比如：Set-Cookie: UserID=JohnDoe; Max-Age=3600; Version=1
- Accept-Ranges  表示服务器是否支持指定范围的请求
- Access-Control-Allow-Origin  设置允许访问该资源的域
- Access-Control-Allow-Methods  允许哪些方法来访问
- Age  从原始服务器到代理缓存形成的预估时间
- Connection  同上
- Content-Length 响应体的长度
- Content-Type  返回内容的MIME类型
- Date  原始服务器消息发出的时间
- Server  web服务器软件名称

## Cache-Control常见取值
- public 这个请求返回的内容所经过的路径无论是代理服务器还是客户端都可以缓存内容
- private  发起请求的浏览器才能使用返回数据的缓存
- no-cache 每次发起请求都要去服务器验证，服务器返回可以使用缓存才可以真正使用本地缓存
- max-age 资源时限
- no-store 响应不被缓存，与no-cache不同，no-cache会缓存，只是每次都要验证

## Cache-Control与expires优先级
expires返回的到期时间是服务器端的时间，这样存在一个问题，如果客户端的时间与服务器的时间相差很大，那么误差就很大

# HTTP1.x/HTTP2
## HTTP1.0
同一时间同一域名的请求数量有限制，超过限制数目请求会被阻塞。只保持短暂连接，每次请求都需要建立TCP连接，完成请求立即断开并且不记录过去请求

## HTTP1.1
默认使用持久连接，不声明Connection: keep-alive也可以使TCP不关闭，可以被多个请求复用。同一TCP连接可同时发送多个请求，但是一个TCP中所有数据按次序进行。一个一个的处理。如果前面的处理的慢，后面的就会阻塞，就是队头阻塞。

## HTTP2
HTTP2性能增强的核心在于二进制分帧层，它定义了如何封装HTTP消息并在客户端和服务端之间进行传输。HTTP1.x以换行符作为纯文本的分隔符，而HTTP2将所有传输信息分割成更小的消息和帧，并对他们采用二进制编码。